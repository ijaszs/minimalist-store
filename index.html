<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Honda Display - Clean</title>
    <style>
        /* --- STYLING --- */
        :root { --bg-color: #f4f6f8; --card-bg: #ffffff; --text-main: #222; }
        body { font-family: sans-serif; background-color: var(--bg-color); margin: 0; padding: 0; padding-bottom: 80px; color: var(--text-main); }
        
        header { padding: 20px; font-weight: 800; font-size: 1.2rem; background: #fff; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; position: sticky; top: 0; z-index: 100; }
        
        .container { padding: 20px; }
        .section-header { font-size: 1.1rem; font-weight: 800; text-transform: uppercase; margin: 30px 0 15px 0; border-left: 4px solid #d32f2f; padding-left: 10px; }

        /* Scroller */
        .product-scroller { display: flex; overflow-x: auto; scroll-snap-type: x mandatory; gap: 20px; padding-bottom: 20px; -webkit-overflow-scrolling: touch; }
        
        /* CLEANER CARD DESIGN */
        .vehicle-card { 
            background: #fff; border-radius: 12px; 
            min-width: 250px; max-width: 250px; /* Slightly narrower */
            scroll-snap-align: center; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); 
            border: 1px solid #eee; overflow: hidden;
            display: flex; flex-direction: column;
            text-align: center; /* Center alignment looks better without price */
        }
        
        .vehicle-image { width: 100%; height: 160px; object-fit: cover; background-color: #eee; }
        
        .vehicle-info { padding: 15px; display: flex; flex-direction: column; gap: 4px; flex-grow: 1; justify-content: center; }
        
        .model-name { font-size: 1.2rem; font-weight: 800; margin: 0; color: #000; }
        .color-name { font-size: 0.95rem; color: #666; font-weight: 500; }

        /* Stock Status */
        .status-bar { padding: 10px; font-weight: bold; font-size: 0.85rem; margin-top: auto; }
        .available { background: #e8f5e9; color: #2e7d32; }
        .sold-out { background: #ffebee; color: #c62828; }

        /* --- HIDDEN ADMIN PANEL --- */
        #admin-section { display: none; margin-top: 40px; background: #fff; border-top: 2px solid #333; padding: 20px; }
        .admin-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee; align-items: center; }
        .login-btn { position: fixed; bottom: 20px; right: 20px; background: #333; color: white; padding: 10px 15px; border-radius: 30px; border: none; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.2); z-index: 200; }
        
        input[type="number"] { width: 50px; padding: 5px; text-align: center; }
        .save-btn { background: black; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body>

    <header>
        <span>HONDA INVENTORY</span>
        <span style="font-size:0.8rem; color:green;">‚óè Live</span>
    </header>

    <div class="container">
        
        <div class="section-header">Scooters</div>
        <div class="product-scroller" id="scooter-list"></div>

        <div class="section-header">Motorcycles</div>
        <div class="product-scroller" id="bike-list"></div>

    </div>

    <div id="admin-section">
        <h3 style="margin-top:0;">Stock Control</h3>
        <div id="admin-list"></div>
        <button onclick="logout()" style="margin-top:20px; background:red; color:white; border:none; padding:10px; border-radius:4px;">Close Admin</button>
    </div>

    <button class="login-btn" onclick="adminLogin()">Staff Login üîí</button>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // YOUR CONFIG
        const firebaseConfig = {
            apiKey: "AIzaSyDmJ6PIj2YinbSodP4Sk39BtOXSx8VG-Ks",
            authDomain: "my-inventory-store.firebaseapp.com",
            projectId: "my-inventory-store",
            storageBucket: "my-inventory-store.firebasestorage.app",
            messagingSenderId: "690261326708",
            appId: "1:690261326708:web:26ba2c1d4a494615f38a21"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // DOM Elements
        const scooterList = document.getElementById('scooter-list');
        const bikeList = document.getElementById('bike-list');
        const adminList = document.getElementById('admin-list');

        // Load Data
        onSnapshot(collection(db, "products"), (snapshot) => {
            scooterList.innerHTML = '';
            bikeList.innerHTML = '';
            adminList.innerHTML = '';

            const items = [];
            snapshot.docs.forEach(doc => items.push({ ...doc.data(), id: doc.id }));
            
            // Sort A-Z by Model
            items.sort((a, b) => (a.model || "").localeCompare(b.model || ""));

            items.forEach(item => {
                const card = createCard(item);
                const category = (item.category || "").toLowerCase();

                // Sort into Categories
                if(category.includes('scooter') || category.includes('scooty')) {
                    scooterList.innerHTML += card;
                } else {
                    bikeList.innerHTML += card;
                }

                // Create Admin Row
                createAdminRow(item);
            });

            // Empty State Messages
            if(scooterList.innerHTML === '') scooterList.innerHTML = '<div style="padding:10px; color:#999">No Scooters</div>';
            if(bikeList.innerHTML === '') bikeList.innerHTML = '<div style="padding:10px; color:#999">No Bikes</div>';
        });

        // 1. Create SIMPLIFIED Card (No Price, No Variant)
        function createCard(v) {
            const img = v.img || "https://placehold.co/400x300?text=No+Image";
            const isStock = v.qty > 0;
            const statusClass = isStock ? "available" : "sold-out";
            const statusText = isStock ? `Available (${v.qty})` : "Sold Out";
            const color = v.color || "Standard Color";

            return `
            <div class="vehicle-card">
                <img src="${img}" class="vehicle-image">
                <div class="vehicle-info">
                    <div class="model-name">${v.model || "Unknown"}</div>
                    <div class="color-name">${color}</div>
                </div>
                <div class="status-bar ${statusClass}">${statusText}</div>
            </div>`;
        }

        // 2. Create Admin Row
        function createAdminRow(v) {
            const div = document.createElement('div');
            div.className = 'admin-row';
            div.innerHTML = `
                <div>
                    <strong>${v.model}</strong> <br>
                    <span style="font-size:0.8rem; color:#666">${v.color}</span>
                </div>
                <div>
                    <input type="number" id="inp-${v.id}" value="${v.qty}" min="0">
                    <button class="save-btn" id="btn-${v.id}">Save</button>
                </div>
            `;
            adminList.appendChild(div);

            document.getElementById(`btn-${v.id}`).addEventListener('click', async () => {
                const btn = document.getElementById(`btn-${v.id}`);
                const val = document.getElementById(`inp-${v.id}`).value;
                btn.innerText = "...";
                try {
                    await updateDoc(doc(db, "products", v.id), { qty: Number(val) });
                    btn.innerText = "OK";
                    setTimeout(() => btn.innerText = "Save", 1000);
                } catch(e) { alert("Error"); }
            });
        }
    </script>

    <script>
        function adminLogin() {
            const password = prompt("Staff Password:");
            if (password === "honda123") {
                document.getElementById('admin-section').style.display = 'block';
                window.scrollTo(0, document.body.scrollHeight);
            } else if(password) {
                alert("Wrong Password!");
            }
        }
        function logout() { document.getElementById('admin-section').style.display = 'none'; }
    </script>
</body>
</html>
